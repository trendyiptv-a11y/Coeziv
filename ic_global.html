<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>Indice coeziv global â€“ stare macro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="Modelul coeziv global: structurÄƒ & direcÈ›ionalitate pentru piaÈ›a financiarÄƒ mondialÄƒ."
  />

  <!-- Chart.js + Luxon (la fel ca pe celelalte pagini) -->
  <script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1"></script>

  <style>
    :root {
      --bg: #020617;
      --bg-soft: #02091c;
      --bg-elevated: #050b1f;
      --card-bg: #050b1f;
      --card-border: rgba(148, 163, 184, 0.15);
      --accent: #4f46e5;
      --accent-soft: rgba(79, 70, 229, 0.15);
      --accent-strong: #a855f7;
      --text: #e5e7eb;
      --text-strong: #f9fafb;
      --text-soft: #9ca3af;
      --muted: #6b7280;
      --success: #22c55e;
      --success-soft: rgba(34, 197, 94, 0.18);
      --danger: #fb7185;
      --danger-soft: rgba(248, 113, 113, 0.18);
      --warn: #eab308;
      --warn-soft: rgba(234, 179, 8, 0.18);
      --radius-card: 1.4rem;
      --radius-pill: 999px;
      --shadow-soft: 0 22px 55px rgba(15, 23, 42, 0.85);
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #020617 0, #020617 35%, #000 100%);
      color: var(--text);
      font-family: var(--font-main);
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    .page {
      width: 100%;
      max-width: 1120px;
      padding: 1.25rem 1.1rem 2.5rem;
    }

    @media (min-width: 768px) {
      .page {
        padding: 1.8rem 1.4rem 2.8rem;
      }
    }

    header {
      margin-bottom: 1.5rem;
    }

    h1 {
      margin: 0 0 0.55rem;
      font-size: 1.25rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-strong);
    }

    header p {
      margin: 0;
      font-size: 0.9rem;
      color: var(--text-soft);
      max-width: 720px;
      line-height: 1.5;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      margin-bottom: 1rem;
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      text-decoration: none;
      color: var(--text-soft);
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .back-link span.icon {
      font-size: 0.9rem;
      transform: translateY(-0.5px);
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.45rem;
      margin-top: 0.95rem;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.3rem 0.75rem;
      border-radius: 999px;
      font-size: 0.76rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.85);
      color: var(--text-soft);
    }

    .pill-dot {
      width: 0.45rem;
      height: 0.45rem;
      border-radius: 999px;
      background: var(--accent-strong);
    }

    .pill.bull .pill-dot {
      background: var(--success);
    }

    .pill.bear .pill-dot {
      background: var(--danger);
    }

    .pill.struct {
      border-color: rgba(129, 140, 248, 0.7);
      background: rgba(79, 70, 229, 0.18);
    }

    .card-grid {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 1rem;
      margin-bottom: 1.4rem;
    }

    @media (min-width: 720px) {
      .card-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .card {
      background: radial-gradient(circle at top left, #020617 0, #020617 28%, #020617 100%);
      border-radius: var(--radius-card);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-soft);
      padding: 1.15rem 1.25rem;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      opacity: 0.18;
      background: radial-gradient(circle at 10% 0, rgba(56, 189, 248, 0.5) 0, transparent 50%);
      pointer-events: none;
      mix-blend-mode: soft-light;
    }

    .card-title {
      position: relative;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
      margin-bottom: 0.4rem;
    }

    .card-value {
      position: relative;
      font-size: 2rem;
      font-weight: 650;
      color: var(--text-strong);
      margin-bottom: 0.25rem;
    }

    .card-label {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.2rem 0;
      font-size: 0.78rem;
      font-weight: 500;
      margin-bottom: 0.2rem;
    }

    .label-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.25rem 0.7rem;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-soft);
      font-size: 0.76rem;
    }

    .label-pill.bull {
      background: var(--success-soft);
      border-color: rgba(34, 197, 94, 0.7);
      color: var(--success);
    }

    .label-pill.bear {
      background: var(--danger-soft);
      border-color: rgba(248, 113, 113, 0.7);
      color: var(--danger);
    }

    .label-pill.neutral {
      background: rgba(30, 64, 175, 0.24);
      border-color: rgba(129, 140, 248, 0.7);
      color: #c4b5fd;
    }

    .label-pill .dot {
      width: 0.42rem;
      height: 0.42rem;
      border-radius: 999px;
      background: currentColor;
    }

    .card-meta {
      position: relative;
      margin-top: 0.3rem;
      font-size: 0.8rem;
      color: var(--text-soft);
      line-height: 1.45;
    }

    .chart-card {
      margin-top: 0.8rem;
      margin-bottom: 1.2rem;
    }

    .chart-title {
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 0.2rem;
      color: var(--text-strong);
    }

    .chart-sub {
      font-size: 0.8rem;
      color: var(--text-soft);
      margin-bottom: 0.7rem;
    }

    .chart-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: radial-gradient(circle at top, #020617 0, #020617 40%, #020617 100%);
      overflow: hidden;
      padding: 0.4rem 0.4rem 0.6rem;
    }

    .chart-wrapper canvas {
      width: 100% !important;
      height: 100% !important;
    }

    .note {
      font-size: 0.82rem;
      color: var(--text-soft);
      line-height: 1.6;
      margin-top: 0.25rem;
    }

    .note strong {
      color: #e5e7eb;
      font-weight: 500;
    }

    .macro-card {
      margin-top: 0.8rem;
    }

    .macro-card p {
      position: relative;
      margin: 0.25rem 0;
      font-size: 0.82rem;
      color: var(--text-soft);
      line-height: 1.6;
    }

    .macro-card em {
      font-style: italic;
    }

    .macro-card strong {
      color: var(--text-strong);
      font-weight: 500;
    }
  </style>
</head>
<body>
  <main class="page">
    <a href="index.html" class="back-link">
      <span class="icon">â†</span>
      <span>Ãnapoi la indice IC_BTC</span>
    </a>

    <header>
      <h1>Indice coeziv global â€“ stare macro</h1>
      <p>
        Model coeziv extins la piaÈ›a financiarÄƒ mondialÄƒ (SPX, VIX, DXY, aur, petrol). Indicii sunt normalizaÈ›i Ã®n
        intervalul 0â€“100 È™i urmÄƒresc echilibrul structural global È™i direcÈ›ionalitatea riscului.
      </p>

      <div class="pill-row">
        <div class="pill struct">
          <span class="pill-dot"></span>
          <span>IC_GLOBAL structural â€“ stabilitate vs. fragilitate globalÄƒ</span>
        </div>
        <div class="pill">
          <span class="pill-dot"></span>
          <span>ICD_GLOBAL direcÈ›ional â€“ apetit vs. aversiune la risc</span>
        </div>
        <div class="pill bull">
          <span class="pill-dot"></span>
          <span>Regim bullish global â€“ risc susÈ›inut</span>
        </div>
        <div class="pill bear">
          <span class="pill-dot"></span>
          <span>Regim bearish global â€“ stres & de-leverage</span>
        </div>
      </div>
    </header>

    <!-- Carduri metrice -->
    <section class="card-grid">
      <article class="card">
        <div class="card-title">IC_GLOBAL structural (0â€“100)</div>
        <div id="icGlobalValue" class="card-value">â€“</div>
        <div class="card-label">
          <span id="icGlobalLabel" class="label-pill neutral">
            <span class="dot"></span>
            <span>Se Ã®ncarcÄƒâ€¦</span>
          </span>
        </div>
        <div id="icGlobalMeta" class="card-meta">
          Evaluare structuralÄƒ globalÄƒ Ã®n curs de Ã®ncÄƒrcare.
        </div>
      </article>

      <article class="card">
        <div class="card-title">ICD_GLOBAL direcÈ›ional (0â€“100)</div>
        <div id="icdGlobalValue" class="card-value">â€“</div>
        <div class="card-label">
          <span id="icdGlobalLabel" class="label-pill neutral">
            <span class="dot"></span>
            <span>Se Ã®ncarcÄƒâ€¦</span>
          </span>
        </div>
        <div id="icdGlobalMeta" class="card-meta">
          DirecÈ›ionalitatea agregatÄƒ a pieÈ›ei (risk-on vs. risk-off).
        </div>
      </article>

      <article class="card">
        <div class="card-title">Regim global curent (model coeziv)</div>
        <div id="regimeValue" class="card-value">â€“</div>
        <div class="card-label">
          <span id="regimePill" class="label-pill neutral">
            <span class="dot"></span>
            <span>Se calculeazÄƒâ€¦</span>
          </span>
        </div>
        <div id="regimeMeta" class="card-meta">
          Regim agregat estimat din IC_GLOBAL structural È™i ICD_GLOBAL direcÈ›ional.
        </div>
      </article>
    </section>

    <!-- Grafic global -->
    <section class="card chart-card">
      <div class="chart-title">Indice structural & direcÈ›ional global (0â€“100)</div>
      <div class="chart-sub">
        Linia albastrÄƒ reprezintÄƒ IC_GLOBAL structural, linia roz reprezintÄƒ ICD_GLOBAL direcÈ›ional (agregat macro).
        Date zilnice, normalizate Ã®n 0â€“100.
      </div>

      <div class="chart-wrapper">
        <canvas id="globalChart"></canvas>
      </div>

      <p class="note" id="lastUpdateNote">
        Se Ã®ncarcÄƒ datele globale...
      </p>
    </section>

    <!-- ExplicaÈ›ii macro -->
    <section class="card macro-card">
      <div class="card-title">Cum interpretÄƒm indicele coeziv global?</div>
      <p>
        <strong>IC_GLOBAL structural</strong> mÄƒsoarÄƒ cÃ¢t de â€aliniateâ€ sunt marile fluxuri ale pieÈ›ei â€“ indice bursier
        global (SPX), volatilitate (VIX), dolar (DXY), aur È™i petrol. Valori ridicate sugereazÄƒ o structurÄƒ
        coerentÄƒ È™i stabilÄƒ, valori foarte scÄƒzute indicÄƒ fragilitate sistemicÄƒ.
      </p>
      <p>
        <strong>ICD_GLOBAL direcÈ›ional</strong> combinÄƒ informaÈ›ia de trend a aceloraÈ™i serii. Niveluri ridicate
        sugereazÄƒ un mediu <em>risk-on</em> (fluxuri orientate cÄƒtre risc), iar niveluri foarte reduse un mediu
        <em>risk-off</em> (aversiune la risc, de-leverage).
      </p>
      <p>
        <strong>Regimul global coeziv</strong> este derivat din combinaÈ›ia celor doi indici:
        structurÄƒ puternicÄƒ + direcÈ›ionalitate pro-risc â‰ˆ regim bullish global;
        structurÄƒ ridicatÄƒ dar direcÈ›ionalitate defensivÄƒ â‰ˆ regim bearish; valori amestecate â‰ˆ
        faze de tranziÈ›ie / reorganizare.
      </p>
      <p>
        Modelul nu Ã®ncearcÄƒ sÄƒ â€prezicÄƒâ€ miÈ™cÄƒri zilnice, ci sÄƒ ofere o lentilÄƒ macro asupra
        <strong>contextului structural</strong> Ã®n care se aflÄƒ Bitcoin È™i restul pieÈ›ei. Nu reprezintÄƒ
        recomandare financiarÄƒ.
      </p>
    </section>

    <!-- Buton + interpretare simplificatÄƒ pentru utilizatori -->
    <a href="#interpretare-coeziva"
       class="btn-interpretare"
       style="display:inline-block; margin:1.4rem 0; padding:0.65rem 1.15rem; background:#1e293b; color:#f8fafc; border-radius:0.5rem; text-decoration:none; border:1px solid rgba(255,255,255,0.1); font-size:0.85rem;">
      Vezi interpretarea completÄƒ â†’
    </a>

    <section id="interpretare-coeziva" class="card" style="margin-top: 0.8rem; padding: 1.5rem;">
      <h2 style="color: #f8fafc; margin-bottom: 1rem; font-size: 1.4rem;">
        Rezumat Simplificat al Modelului Coeziv Global
      </h2>

      <p style="color: #cbd5e1; margin-bottom: 1rem;">
        Modelul Coeziv Global analizeazÄƒ evoluÈ›ia marilor active financiare (SPX, DXY, GOLD, OIL È™i VIX) folosind
        date reale din 2009 pÃ¢nÄƒ Ã®n prezent. El mÄƒsoarÄƒ:
      </p>

      <ul style="color: #cbd5e1; padding-left: 1.2rem; margin-bottom: 1rem; line-height: 1.6;">
        <li><strong>IC Global (structurÄƒ)</strong> â€“ cÃ¢t de stabilÄƒ este piaÈ›a globalÄƒ pe termen lung.</li>
        <li><strong>ICD Global (direcÈ›ionalitate)</strong> â€“ impulsul pieÈ›ei pe termen scurt È™i mediu.</li>
      </ul>

      <h3 style="color: #f1f5f9; margin-top: 1.2rem;">Ce Ã®nseamnÄƒ scorurile actuale?</h3>

      <p style="color: #cbd5e1; margin-bottom: 1rem;">Ãn prezent, modelul indicÄƒ:</p>

      <ul style="color: #cbd5e1; padding-left: 1.2rem; line-height: 1.6; margin-bottom: 1rem;">
        <li><strong>IC Global â‰ˆ 80</strong> â€“ structurÄƒ globalÄƒ puternicÄƒ È™i coerentÄƒ.</li>
        <li><strong>ICD Global â‰ˆ 80</strong> â€“ direcÈ›ionalitate sÄƒnÄƒtoasÄƒ, orientatÄƒ spre risc.</li>
      </ul>

      <p style="color: #cbd5e1; font-style: italic; margin-bottom: 1.5rem;">
        Interpretare simplÄƒ: <strong>context global pozitiv, matur È™i stabil</strong>.
      </p>

      <h3 style="color: #f1f5f9; margin-top: 1.2rem;">De ce graficul Ã®ncepe doar Ã®n 2018?</h3>
      <p style="color: #cbd5e1; margin-bottom: 1rem;">
        Modelul foloseÈ™te toate datele comune din 2009â€“2025, dar graficul aratÄƒ doar ultimele 2000 de zile
        pentru claritate È™i performanÈ›Äƒ. Analiza completÄƒ rÄƒmÃ¢ne mult mai largÄƒ decÃ¢t porÈ›iunea afiÈ™atÄƒ.
      </p>

      <p style="color: #94a3b8; margin-bottom: 1.5rem;">
        Important: <strong>modelul interpreteazÄƒ toatÄƒ perioada 2009â€“2025</strong>, chiar dacÄƒ graficul afiÈ™eazÄƒ doar perioada recentÄƒ.
      </p>

      <h3 style="color: #f1f5f9; margin-top: 1.2rem;">Cum interpretezi valorile dacÄƒ se schimbÄƒ?</h3>

      <ul style="color: #cbd5e1; padding-left: 1.2rem; margin-bottom: 1.5rem; line-height: 1.6;">
        <li><strong>IC Global creÈ™te</strong> â†’ piaÈ›Äƒ mai stabilÄƒ.</li>
        <li><strong>IC Global scade</strong> â†’ apar tensiuni structurale.</li>
        <li><strong>ICD Global creÈ™te</strong> â†’ impuls pozitiv.</li>
        <li><strong>ICD Global scade</strong> â†’ pierdere de momentum.</li>
      </ul>

      <p style="color: #94a3b8; margin-bottom: 1.5rem;">
        Regula uÈ™oarÄƒ:
        <br>ğŸŸ¢ <strong>peste 65</strong> â†’ context pozitiv  
        <br>ğŸŸ¡ <strong>40â€“65</strong> â†’ tranziÈ›ie  
        <br>ğŸ”´ <strong>sub 40</strong> â†’ context fragil  
      </p>

      <h3 style="color: #f1f5f9; margin-top: 1.2rem;">Concluzie</h3>
      <p style="color: #cbd5e1; line-height: 1.6;">
        Modelul Coeziv Global oferÄƒ o imagine clarÄƒ asupra stÄƒrii pieÈ›elor internaÈ›ionale.
        DeÈ™i graficul afiÈ™eazÄƒ doar ultimii ani, analiza completÄƒ foloseÈ™te toate datele disponibile.
        Scorurile actuale aratÄƒ o piaÈ›Äƒ globalÄƒ stabilÄƒ È™i bine aliniatÄƒ.
      </p>
    </section>
  </main>

  <script>
    const { DateTime } = luxon;

    function classifyLevel(value, low, high) {
      if (value == null || !Number.isFinite(value)) return { label: "necunoscut", mode: "neutral" };
      if (value >= high) return { label: "ridicat", mode: "bull" };
      if (value <= low) return { label: "scÄƒzut", mode: "bear" };
      return { label: "mediu", mode: "neutral" };
    }

    function describeIC(value, low, high) {
      if (value == null || !Number.isFinite(value)) return "Indice structural indisponibil.";
      if (value >= high) {
        return "StructurÄƒ globalÄƒ coerentÄƒ, fluxurile mari sunt bine aliniate. Context macro relativ stabil.";
      }
      if (value <= low) {
        return "StructurÄƒ fragilÄƒ: corelaÈ›ii tensionate Ã®ntre acÈ›iuni, volatilitate, dolar, aur È™i petrol.";
      }
      return "StructurÄƒ mixtÄƒ: piaÈ›a oscileazÄƒ Ã®ntre episoade de stabilitate È™i tensiuni punctuale.";
    }

    function describeICD(value, low, high) {
      if (value == null || !Number.isFinite(value)) return "Indice direcÈ›ional indisponibil.";
      if (value >= high) {
        return "Regim global orientat spre risc (risk-on) â€“ fluxuri pro-ciclice, apetit pentru active riscante.";
      }
      if (value <= low) {
        return "Regim defensiv (risk-off) â€“ creÈ™tere de aversiune la risc, cÄƒutare de refugii È™i reducere de expuneri.";
      }
      return "DirecÈ›ionalitate neutrÄƒ sau mixtÄƒ: piaÈ›a Ã®ncÄƒ testeazÄƒ un scenariu dominant.";
    }

    function describeRegime(regime, lastDate) {
      const d = lastDate ? DateTime.fromMillis(lastDate).toFormat("dd LLL yyyy") : "ultima datÄƒ";
      if (regime === "bull") {
        return `Regim global bullish coeziv: structurÄƒ solidÄƒ + fluxuri pro-risc, valabil aproximativ la ${d}.`;
      }
      if (regime === "bear") {
        return `Regim global bearish coeziv: structurÄƒ ridicatÄƒ dar orientare defensivÄƒ a fluxurilor, valabil la ${d}.`;
      }
      return `FazÄƒ de tranziÈ›ie / reorganizare globalÄƒ detectatÄƒ la ${d}: structura È™i direcÈ›ia nu indicÄƒ Ã®ncÄƒ un regim clar.`;
    }

    function setPillClass(el, mode) {
      el.classList.remove("bull", "bear", "neutral");
      if (mode === "bull") el.classList.add("bull");
      else if (mode === "bear") el.classList.add("bear");
      else el.classList.add("neutral");
    }

    async function init() {
      const icValueEl = document.getElementById("icGlobalValue");
      const icLabelEl = document.getElementById("icGlobalLabel");
      const icMetaEl = document.getElementById("icGlobalMeta");

      const icdValueEl = document.getElementById("icdGlobalValue");
      const icdLabelEl = document.getElementById("icdGlobalLabel");
      const icdMetaEl = document.getElementById("icdGlobalMeta");

      const regimeValueEl = document.getElementById("regimeValue");
      const regimePillEl = document.getElementById("regimePill");
      const regimeMetaEl = document.getElementById("regimeMeta");
      const lastUpdateNote = document.getElementById("lastUpdateNote");

      try {
        const resp = await fetch("data/global_coeziv_state.json");
        if (!resp.ok) throw new Error("Nu am putut Ã®ncÄƒrca global_coeziv_state.json");
        const data = await resp.json();

        const series = Array.isArray(data.series) ? data.series : [];
        if (!series.length) {
          lastUpdateNote.textContent = "global_coeziv_state.json nu conÈ›ine serii valabile.";
          return;
        }

        const thresholds = data.thresholds || {};
        const icLow = thresholds.ic_low ?? 35;
        const icHigh = thresholds.ic_high ?? 65;
        const icdLow = thresholds.icd_low ?? 40;
        const icdHigh = thresholds.icd_high ?? 60;

        const current = data.current || series[series.length - 1];
        const lastTs = current.t ?? series[series.length - 1].t;
        const lastDate = DateTime.fromMillis(lastTs);
        const lastDateLabel = lastDate.toFormat("dd LLL yyyy");

        const icVal = Number(current.ic_global);
        const icdVal = Number(current.icd_global);

        // IC_GLOBAL card
        icValueEl.textContent = Number.isFinite(icVal) ? icVal.toFixed(2) : "â€“";
        const icLevel = classifyLevel(icVal, icLow, icHigh);
        setPillClass(icLabelEl, icLevel.mode);
        icLabelEl.querySelector("span:last-child").textContent = `IC_GLOBAL ${icLevel.label}`;
        icMetaEl.textContent = describeIC(icVal, icLow, icHigh);

        // ICD_GLOBAL card
        icdValueEl.textContent = Number.isFinite(icdVal) ? icdVal.toFixed(2) : "â€“";
        const icdLevel = classifyLevel(icdVal, icdLow, icdHigh);
        setPillClass(icdLabelEl, icdLevel.mode);
        icdLabelEl.querySelector("span:last-child").textContent = `ICD_GLOBAL ${icdLevel.label}`;
        icdMetaEl.textContent = describeICD(icdVal, icdLow, icdHigh);

        // Regim global
        const regime = current.regime || "neutral";
        if (regime === "bull") {
          regimeValueEl.textContent = "bullish global";
          setPillClass(regimePillEl, "bull");
          regimePillEl.querySelector("span:last-child").textContent = "Regim coeziv bullish";
        } else if (regime === "bear") {
          regimeValueEl.textContent = "bearish global";
          setPillClass(regimePillEl, "bear");
          regimePillEl.querySelector("span:last-child").textContent = "Regim coeziv bearish";
        } else {
          regimeValueEl.textContent = "tranziÈ›ie / neutru";
          setPillClass(regimePillEl, "neutral");
          regimePillEl.querySelector("span:last-child").textContent = "FazÄƒ de tranziÈ›ie globalÄƒ";
        }
        regimeMetaEl.textContent = describeRegime(regime, lastTs);

        lastUpdateNote.textContent = `Ultima datÄƒ de actualizare: ${lastDateLabel}. Pragurile sunt adaptate automat la distribuÈ›ia indicilor globali.`;

        // Grafic
        const labels = series.map(d => d.t);
        const icSeries = series.map(d => d.ic_global ?? null);
        const icdSeries = series.map(d => d.icd_global ?? null);

        const ctx = document.getElementById("globalChart").getContext("2d");
        new Chart(ctx, {
          type: "line",
          data: {
            labels,
            datasets: [
              {
                label: "IC_GLOBAL structural (0â€“100)",
                data: icSeries,
                borderWidth: 1.8,
                tension: 0.22,
                pointRadius: 0,
              },
              {
                label: "ICD_GLOBAL direcÈ›ional (0â€“100)",
                data: icdSeries,
                borderWidth: 1.4,
                borderDash: [4, 3],
                tension: 0.18,
                pointRadius: 0,
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
              mode: "index",
              intersect: false
            },
            plugins: {
              legend: {
                display: true,
                labels: {
                  color: "#cbd5f5",
                  font: { size: 11 }
                }
              },
              tooltip: {
                callbacks: {
                  title(items) {
                    if (!items.length) return "";
                    const t = items[0].parsed.x;
                    return DateTime.fromMillis(t).toFormat("dd LLL yyyy");
                  },
                  label(item) {
                    const v = item.parsed.y;
                    if (v == null || !Number.isFinite(v)) return "";
                    return `${item.dataset.label}: ${v.toFixed(2)}`;
                  }
                }
              }
            },
            scales: {
              x: {
                type: "time",
                time: { unit: "year" },
                grid: { display: false },
                ticks: {
                  color: "#9ca3af",
                  maxRotation: 0,
                  autoSkipPadding: 24
                }
              },
              y: {
                min: 0,
                max: 100,
                grid: {
                  color: "rgba(148, 163, 184, 0.28)",
                  drawBorder: false
                },
                ticks: {
                  color: "#9ca3af",
                  stepSize: 20
                }
              }
            }
          }
        });
      } catch (err) {
        console.error(err);
        lastUpdateNote.textContent =
          "Eroare la Ã®ncÄƒrcarea datelor globale. VerificÄƒ existenÈ›a fiÈ™ierului data/global_coeziv_state.json.";
      }
    }

    init();
  </script>

  <script>
    // Smooth scroll pentru linkurile interne (#interpretare-coeziva etc.)
    document.addEventListener("DOMContentLoaded", function () {
      document.querySelectorAll('a[href^="#"]').forEach(link => {
        link.addEventListener("click", function (e) {
          const target = document.querySelector(this.getAttribute("href"));
          if (!target) return;
          e.preventDefault();
          target.scrollIntoView({ behavior: "smooth" });
        });
      });
    });
  </script>
</body>
</html>

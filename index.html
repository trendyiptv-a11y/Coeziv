<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coeziv 3.14Î” â€“ Analizor InformaÈ›ional</title>
  <style>
    :root {
      --bg: #0d1117;
      --panel: #161b22;
      --text: #c9d1d9;
      --accent: #00ffb7;
      --gray: #777;
      --green: #00ffb7;
      --yellow: #ffc800;
      --red: #ff0055;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: "Segoe UI", sans-serif;
      text-align: center;
      margin: 0;
      padding: 2rem 1rem;
    }

    h1 {
      color: var(--accent);
      font-size: 1.8rem;
    }

    textarea {
      width: 90%;
      max-width: 600px;
      height: 120px;
      background-color: var(--panel);
      color: var(--text);
      border: 1px solid #30363d;
      border-radius: 12px;
      padding: 0.8rem;
      font-size: 1rem;
      resize: none;
      outline: none;
    }

    button {
      background-color: var(--accent);
      color: #000;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      padding: 0.7rem 1.5rem;
      margin-top: 1rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    button:hover {
      filter: brightness(1.2);
    }

    #result {
      max-width: 800px;
      background: var(--panel);
      margin: 2rem auto;
      padding: 1.5rem;
      border-radius: 16px;
      text-align: left;
      line-height: 1.5;
      font-size: 0.95rem;
      box-shadow: 0 0 10px #0006;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    footer {
      margin-top: 2rem;
      font-size: 0.8rem;
      color: #777;
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <h1>ğŸ§  Coeziv 3.14Î”</h1>
  <p>Analizor informaÈ›ional â€“ detecteazÄƒ nivelul de coeziune, vibraÈ›ie È™i manipulare semanticÄƒ.</p>

  <textarea id="textInput" placeholder="Scrie o afirmaÈ›ie pentru analizÄƒ..."></textarea><br>
  <button onclick="analyzeText()">ğŸ” AnalizeazÄƒ InformaÈ›ia</button>

  <div id="result"></div>

  <footer>
    Â© 2025 Coeziv 3.14Î” â€“ Verificare factualÄƒ triplÄƒ (semantic + factual + logic)
  </footer>

  <script>
    async function analyzeText() {
      const text = document.querySelector("#textInput").value.trim();
      const resultBox = document.querySelector("#result");

      if (!text) {
        resultBox.innerHTML = "âš ï¸ Introdu o afirmaÈ›ie pentru analizÄƒ.";
        return;
      }

      resultBox.innerHTML = "ğŸ”„ AnalizÄƒ Ã®n curs...";

      try {
        const response = await fetch("/api/analyze-web", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text }),
        });

        const data = await response.json();
        const { analysis, confidence, sources } = data;

        let verdict = "";
        let verdictColor = "";

        // ğŸ” regulÄƒ: fÄƒrÄƒ minimum 3 surse â†’ analizÄƒ suspendatÄƒ
        if (!sources || sources.length < 3) {
          verdict = "âš ï¸ AnalizÄƒ suspendatÄƒ â€“ insuficiente surse factuale (minim 3 necesare).";
          verdictColor = "#777";
        } else if (confidence < 40) {
          verdict = "ğŸŸ¢ Grad redus de manipulare â€“ informaÈ›ie confirmatÄƒ factual.";
          verdictColor = "#00ffb7";
        } else if (confidence < 70) {
          verdict = "ğŸŸ¡ Risc moderat â€“ recomandÄƒm verificare suplimentarÄƒ.";
          verdictColor = "#ffc800";
        } else {
          verdict = "ğŸ”´ Grad ridicat de manipulare â€“ necesitÄƒ confirmare factualÄƒ.";
          verdictColor = "#ff0055";
        }

        // ğŸ”— afiÈ™are surse
        let sourcesHTML = sources
          .map((s) => `<li><a href="${s.url}" target="_blank">${s.title}</a></li>`)
          .join("");

        if (!sourcesHTML)
          sourcesHTML = "<li>Nicio sursÄƒ factualÄƒ relevantÄƒ gÄƒsitÄƒ.</li>";

        resultBox.innerHTML = `
          <div style="border:2px solid ${verdictColor};border-radius:12px;padding:1rem;margin-top:1rem;">
            <strong style="color:${verdictColor}">${verdict}</strong><br>
            <small>Indice de Ã®ncredere: ${confidence}%</small>
          </div>
          <p>${analysis}</p>
          <h4>ğŸ” Surse factuale:</h4>
          <ul>${sourcesHTML}</ul>
          <p><small>ğŸ§  AnalizÄƒ efectuatÄƒ de Motorul Coeziv 3.14Î” â€“ bazatÄƒ pe date publice, web factual È™i verificare semanticÄƒ autonomÄƒ.</small></p>
        `;
      } catch (err) {
        resultBox.innerHTML = "âš ï¸ Eroare la conexiunea cu motorul semantic.";
      }
    }
  </script>
</body>
</html>

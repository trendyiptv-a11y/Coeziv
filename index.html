<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formula 3.14Œî ‚Äî Detector de Informa»õii Viu</title>
  <style>
    body {
      background: #0d1117;
      color: #e6edf3;
      font-family: "Segoe UI", sans-serif;
      text-align: center;
      margin: 0;
      padding: 1em;
    }
    h1 {
      color: #00ffb7;
      margin-bottom: 0.1em;
    }
    p {
      color: #9ba1a6;
      margin-top: 0;
    }
    textarea {
      width: 95%;
      max-width: 650px;
      height: 180px;
      background: #161b22;
      color: #c9d1d9;
      border: 1px solid #30363d;
      border-radius: 10px;
      padding: 1em;
      font-size: 1em;
      resize: none;
    }
    button {
      margin-top: 1em;
      background: #00ffb7;
      color: #000;
      border: none;
      border-radius: 8px;
      padding: 0.8em 1.6em;
      cursor: pointer;
      font-weight: bold;
      font-size: 1em;
      transition: background 0.2s;
    }
    button:hover {
      background: #00cc8f;
    }
    .result {
      margin: 1.5em auto;
      width: 95%;
      max-width: 700px;
      background: #161b22;
      padding: 1.5em;
      border-radius: 12px;
      border: 1px solid #30363d;
      text-align: left;
      line-height: 1.5;
      white-space: pre-wrap;
    }
    canvas {
      margin-top: 1em;
      background: #0d1117;
    }
    .verdict-bar {
      margin: 1em auto;
      width: 90%;
      max-width: 500px;
      height: 25px;
      border-radius: 10px;
      transition: background 0.5s;
    }
    .legend {
      margin-top: 0.6em;
      color: #aaa;
      font-size: 0.9em;
    }
    footer {
      margin-top: 1em;
      color: #777;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <h1>Formula 3.14Œî</h1>
  <p>Motor de analizƒÉ informa»õionalƒÉ ‚Äî GPT-5</p>

  <textarea id="textInput" placeholder="Introdu textul pentru analizƒÉ..."></textarea>
  <br />
  <button id="analyzeBtn">AnalizeazƒÉ</button>

  <div class="result" id="result">Aici vor apƒÉrea rezultatele...</div>
  <div class="verdict-bar" id="verdictBar"></div>
  <canvas id="chart" width="320" height="180"></canvas>

  <div class="legend">
    ‚úÖ Verde = Veridic / Coeziv‚ÄÉ|‚ÄÉ‚ö†Ô∏è Galben = Ambiguu / incert‚ÄÉ|‚ÄÉüî¥ Ro»ôu = Fals / Manipulator
  </div>

  <footer>¬© 2025 Formula 3.14Œî ‚Äî Sergiu BulboacƒÉ</footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById("chart").getContext("2d");
  const chart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["Fc (Coeziune)", "Œî (Vibra»õie)", "Manipulare %"],
      datasets: [{
        label: "Valori analizƒÉ",
        data: [0, 0, 0],
        backgroundColor: ["#00ffb7", "#ffcc00", "#ff3366"]
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true, max: 6.3, ticks: { color: "#ccc" } },
        x: { ticks: { color: "#ccc" } }
      },
      plugins: { legend: { display: false } }
    }
  });

  const verdictBar = document.getElementById("verdictBar");
  const resultDiv = document.getElementById("result");

  // ‚úÖ verdict text mare
  const verdictText = document.createElement("div");
  verdictText.style.fontSize = "1.4em";
  verdictText.style.fontWeight = "bold";
  verdictText.style.marginTop = "0.8em";
  verdictText.style.transition = "color 0.4s";
  document.body.insertBefore(verdictText, verdictBar);

  document.getElementById("analyzeBtn").addEventListener("click", async () => {
    const text = document.getElementById("textInput").value.trim();
    if (!text) {
      resultDiv.textContent = "‚ö†Ô∏è Introdu un text pentru analizƒÉ.";
      return;
    }

    resultDiv.textContent = "‚è≥ AnalizƒÉ √Æn curs...";
    verdictBar.style.background = "#444";
    verdictText.textContent = "";

    try {
      const response = await fetch("/api/analyze", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ textDeAnalizat: text }),
      });

      const data = await response.json();
      if (data.success) {
        const { fc, delta, manipulare, text: rezumat } = data.rezultat;
        resultDiv.textContent = rezumat;

        chart.data.datasets[0].data = [fc, delta, manipulare];
        chart.update();

        // üß† Verdict vizual + text logic
        let verdictColor = "#00ffb7";
        let verdictMsg = "‚úÖ Veridic / Coeziv";

        if (rezumat.toLowerCase().includes("fals") || rezumat.toLowerCase().includes("dezinformare")) {
          verdictColor = "#ff3366";
          verdictMsg = "üî¥ Fals logic / Dezinformare";
        } else if (rezumat.toLowerCase().includes("ambiguu") || manipulare > 25) {
          verdictColor = "#ffcc00";
          verdictMsg = "‚ö†Ô∏è Ambiguu / Incomplet";
        } else if (rezumat.toLowerCase().includes("veridic") || manipulare < 20) {
          verdictColor = "#00ffb7";
          verdictMsg = "‚úÖ Veridic / Coeziv";
        }

        verdictBar.style.background = verdictColor;
        verdictText.textContent = verdictMsg;
        verdictText.style.color = verdictColor;
      } else {
        resultDiv.textContent = "‚ùå Eroare: " + data.error;
        verdictText.textContent = "‚ùå Eroare API";
        verdictBar.style.background = "#ff3366";
      }
    } catch (err) {
      resultDiv.textContent = "‚ö†Ô∏è Eroare de conexiune cu motorul GPT.";
      verdictBar.style.background = "#ff3366";
      verdictText.textContent = "‚ö†Ô∏è Eroare conexiune";
      verdictText.style.color = "#ff3366";
    }
  });
</script>
</body>
</html>


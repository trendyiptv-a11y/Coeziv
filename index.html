<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coeziv 3.14Δ</title>
  <style>
    :root {
      --bg: #0d1117;
      --panel: #161b22;
      --accent: #00ffb7;
      --warning: #ffc107;
      --danger: #ff5555;
      --text: #c9d1d9;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: "Segoe UI", sans-serif;
      text-align: center;
      margin: 0;
      padding: 1.5rem;
    }

    h1 {
      color: var(--accent);
      font-size: 2rem;
      margin-bottom: 0.4rem;
    }

    p {
      color: #9ba1a6;
      margin-bottom: 1rem;
    }

    textarea {
      width: 90%;
      max-width: 600px;
      height: 80px;
      background: var(--panel);
      color: var(--text);
      border: 1px solid #333;
      border-radius: 10px;
      padding: 10px;
      resize: none;
      font-size: 1rem;
    }

    button {
      margin-top: 1rem;
      background: var(--accent);
      border: none;
      border-radius: 10px;
      padding: 0.8rem 1.2rem;
      font-size: 1rem;
      cursor: pointer;
      color: #000;
      font-weight: 600;
      box-shadow: 0 0 8px rgba(0, 255, 183, 0.4);
    }

    button:hover {
      background: #00e5a5;
    }

    .card {
      background: var(--panel);
      border-radius: 12px;
      padding: 1.2rem;
      margin: 1.5rem auto;
      max-width: 700px;
      text-align: left;
      box-shadow: 0 0 10px rgba(0, 255, 183, 0.08);
    }

    h2 {
      color: var(--accent);
      margin-top: 0;
    }

    .verdict {
      font-weight: 600;
      margin-top: 1rem;
      padding: 0.8rem;
      border-radius: 8px;
      text-align: center;
    }

    .verdict.green {
      color: #00ffb7;
    }

    .verdict.yellow {
      color: #ffc107;
    }

    .verdict.red {
      color: #ff5555;
    }

    .auth {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #8b949e;
      text-align: center;
      border-top: 1px solid #222;
      padding-top: 0.8rem;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    footer {
      margin-top: 2rem;
      color: #6e7681;
      font-size: 0.9rem;
    }

    ul {
      list-style: none;
      padding-left: 1rem;
    }

    li {
      margin-bottom: 0.4rem;
    }
  </style>
</head>

<body>
  <h1>🧠 Coeziv 3.14Δ</h1>
  <p>Analizor informațional – detectează nivelul de coeziune, vibrație și manipulare semantică.</p>

  <textarea id="inputText" placeholder="Scrie o afirmație pentru analiză..."></textarea>
  <br />
  <button id="analyzeBtn">🔍 Analizează Informația</button>

  <div id="result" class="card" style="display: none;">
    <h2>🧩 Analiză completă Coeziv 3.14Δ</h2>
    <div id="analysis">Analiza în curs...</div>

    <div id="verdictBox" class="verdict">...</div>

    <h3>🔎 Surse factuale:</h3>
    <ul id="sources"></ul>

    <div class="auth">
      🧠 Analiză efectuată de <strong>Motorul Coeziv 3.14Δ</strong> – bazată pe date publice, web factual și verificare semantică autonomă.
    </div>
  </div>

  <footer>© 2025 Coeziv 3.14Δ</footer>

  <script>
    document.getElementById("analyzeBtn").addEventListener("click", async () => {
      const text = document.getElementById("inputText").value.trim();
      const result = document.getElementById("result");
      const analysisEl = document.getElementById("analysis");
      const sourcesEl = document.getElementById("sources");
      const verdictEl = document.getElementById("verdictBox");

      if (!text) {
        alert("Te rog introdu un text pentru analiză.");
        return;
      }

      result.style.display = "block";
      analysisEl.innerHTML = "🔄 Analiză în desfășurare...";
      sourcesEl.innerHTML = "";
      verdictEl.textContent = "";

      try {
        const res = await fetch(`/api/analyze-web?query=${encodeURIComponent(text)}`);
        const data = await res.json();

        // 🧠 Afișăm analiza semantică completă (Δ, Fc, Manipulare)
        if (data.analysis) {
          const formatted = data.analysis
            .replace(/\n/g, "<br>")
            .replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");
          analysisEl.innerHTML = formatted;
        } else {
          analysisEl.textContent = "Nicio analiză disponibilă.";
        }

        // 🧭 Verdict colorat + Indice veridicitate
        const conf = data.confidence || 50;
        let verdictText = "";
        let verdictClass = "";

        if (conf > 80) {
          verdictText = `✅ Informație verificată / factuală – grad redus de manipulare (Indice: ${conf}%)`;
          verdictClass = "green";
        } else if (conf >= 50) {
          verdictText = `⚠️ Informație parțial verificată – necesită confirmare suplimentară (Indice: ${conf}%)`;
          verdictClass = "yellow";
        } else {
          verdictText = `❌ Informație neverificată sau contradictorie (Indice: ${conf}%)`;
          verdictClass = "red";
        }

        verdictEl.textContent = verdictText;
        verdictEl.className = `verdict ${verdictClass}`;

        // 🔗 Surse factuale
        if (data.sources && data.sources.length > 0) {
          sourcesEl.innerHTML = data.sources
            .map((s) => `<li><a href="${s.url}" target="_blank">${s.title}</a></li>`)
            .join("");
        } else {
          sourcesEl.innerHTML = "<li>Nicio sursă factuală relevantă găsită.</li>";
        }
      } catch (err) {
        analysisEl.textContent = `⚠️ Eroare de conexiune: ${err.message}`;
      }
    });
  </script>
</body>
</html>

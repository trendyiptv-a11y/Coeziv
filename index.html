<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Motor Coeziv 3.14</title>
<style>
  body {
    background-color: #0d1117;
    color: #c9d1d9;
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
    padding: 2rem 1rem;
    overflow-x: hidden;
  }
  h1 {
    color: #00ffb7;
    font-size: 2rem;
    margin-bottom: 0.3rem;
  }
  p { color: #9ba1a6; }

  textarea {
    width: 90%;
    max-width: 500px;
    height: 100px;
    border-radius: 10px;
    border: none;
    padding: 10px;
    background: #161b22;
    color: #fff;
    resize: none;
  }

  button {
    border: none;
    border-radius: 10px;
    padding: 10px 20px;
    margin: 8px 5px;
    cursor: pointer;
    font-weight: 600;
    transition: 0.3s;
  }
  .btn-main {
    background: #00ffb7;
    color: #000;
  }
  .btn-main:hover { background: #00cfa0; }

  .btn-human {
    background: #ffc800;
    color: #000;
  }
  .btn-human:hover { background: #e6b400; }

  .btn-info {
    background: transparent;
    border: 1px solid #00ffb7;
    color: #00ffb7;
  }
  .btn-collections {
    background: #fff;
    color: #000;
  }

  #result { margin-top: 1rem; color: #fff; }

  /* Card mic Stare de funcÈ›ionare */
  #coeziv-card {
    position: fixed;
    bottom: 10px;
    right: 10px;
    background: rgba(15, 17, 21, 0.85);
    color: #f1f1f1;
    font-size: 0.8rem;
    padding: 5px 10px;
    border-radius: 10px;
    box-shadow: 0 0 10px 2px #00ff88;
    z-index: 1000;
  }
</style>
</head>
<body>

  <h1>Motor Coeziv 3.14</h1>
  <p>AnalizÄƒ factualÄƒ, logicÄƒ, semanticÄƒ È™i umanÄƒ</p>

  <textarea id="inputText" placeholder="Scrie o afirmaÈ›ie..."></textarea><br>

  <button class="btn-main" onclick="analizeazaAfirmatia()">ðŸ§  AnalizeazÄƒ afirmaÈ›ia</button>
  <button class="btn-human" onclick="analizeazaUman()">ðŸŒ¿ AnalizeazÄƒ prin Î”H (uman)</button><br>

  <button class="btn-info" onclick="window.location='document/model.html'">Despre Modelul Coeziv 3.14</button>
  <button class="btn-collections" onclick="window.location='collections.html'">ðŸ”­ ColecÈ›ii Coezive</button>

  <div id="result"></div>

  <!-- Panoul manifest corect -->
  <div id="manifest-panel" class="partial"></div>

  <!-- Card mic de stare -->
  <div id="coeziv-card">
    <span id="deltaText">Stare de funcÈ›ionare: actualizare vie...</span>
  </div>

<script>
function analizeazaAfirmatia() {
  const text = document.getElementById("inputText").value.trim();
  if (!text) return alert("Scrie o afirmaÈ›ie!");
  document.getElementById("result").innerHTML = "<p>AnalizÄƒm afirmaÈ›ia...</p>";
  fetch(`/api/analyze?text=${encodeURIComponent(text)}`)
    .then(r => r.json())
    .then(d => { document.getElementById("result").innerHTML = d.result; })
    .catch(() => { document.getElementById("result").innerHTML = "Eroare la analizÄƒ."; });
}

function analizeazaUman() {
  document.getElementById("result").innerHTML = "AnalizÄƒ Î”H (umanÄƒ) Ã®n curs...";
  fetch(`/api/human?text=${encodeURIComponent(document.getElementById("inputText").value)}`)
    .then(r => r.json())
    .then(d => { document.getElementById("result").innerHTML = d.result; })
    .catch(() => { document.getElementById("result").innerHTML = "Eroare la analiza umanÄƒ."; });
}

async function actualizeazaFormulaViva() {
  try {
    const r = await fetch('/manifest.json');
    const manifest = await r.json();
    const dh = parseFloat(manifest.cohesionState?.value || 2.57);
    const text = document.getElementById('deltaText');
    let mesaj = "Stare de funcÈ›ionare: ";

    if (dh < 2.8) mesaj += "instabilÄƒ ðŸŸ¥";
    else if (dh < 3.13) mesaj += "normalÄƒ ðŸŸ¨";
    else mesaj += "optimÄƒ ðŸŸ©";

    text.textContent = mesaj;

    const card = document.getElementById('coeziv-card');
    if (dh < 2.8) card.style.boxShadow = '0 0 10px 2px #ff4444';
    else if (dh < 3.13) card.style.boxShadow = '0 0 10px 2px #ffbb00';
    else card.style.boxShadow = '0 0 10px 2px #00ff88';

    setTimeout(actualizeazaFormulaViva, 30000);
  } catch (e) { console.warn('Eroare actualizare vie:', e); }
}
actualizeazaFormulaViva();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coeziv 3.14 — Motor de analiză informațională </title>
  <style>
    body {
      background: #0d1117;
      color: #e6edf3;
      font-family: "Segoe UI", sans-serif;
      text-align: center;
      margin: 0;
      padding: 1em;
    }
    h1 {
      color: #00ffb7;
      margin-bottom: 0.1em;
    }
    p {
      color: #9ba1a6;
      margin-top: 0;
    }
    textarea {
      width: 95%;
      max-width: 650px;
      height: 180px;
      background: #161b22;
      color: #c9d1d9;
      border: 1px solid #30363d;
      border-radius: 10px;
      padding: 1em;
      font-size: 1em;
      resize: none;
    }
    button {
      margin-top: 1em;
      background: #00ffb7;
      color: #000;
      border: none;
      border-radius: 8px;
      padding: 0.8em 1.6em;
      cursor: pointer;
      font-weight: bold;
      font-size: 1em;
      transition: background 0.2s;
    }
    button:hover {
      background: #00cc8f;
    }
    .result {
      margin: 1.5em auto;
      width: 95%;
      max-width: 700px;
      background: #161b22;
      padding: 1.5em;
      border-radius: 12px;
      border: 1px solid #30363d;
      text-align: left;
      line-height: 1.5;
      white-space: pre-wrap;
    }
    canvas {
      margin-top: 1em;
      background: #0d1117;
    }
    .verdict-bar {
      margin: 1em auto;
      width: 90%;
      max-width: 500px;
      height: 25px;
      border-radius: 10px;
      transition: background 0.5s;
    }
    .legend {
      margin-top: 0.6em;
      color: #aaa;
      font-size: 0.9em;
    }
    footer {
      margin-top: 1em;
      color: #777;
      font-size: 0.9em;
      .badge {
  background-color: #00ffb7;
  color: #0d1117;
  font-size: 0.7em;
  font-weight: bold;
  padding: 2px 5px;
  border-radius: 6px;
  margin-right: 5px;
}
.badge.gray {
  background-color: #444;
  color: #bbb;
}
.source-item {
  margin: 4px 0;
  animation: fadeIn 0.6s ease-in;
}
    }
  </style>
</head>
<body>
  <h1>Coeziv 3.14</h1>
  <p>Motor de analiză informațională</p>

  <textarea id="textInput" placeholder="Introdu textul pentru analiză..."></textarea>
  <br />
  <button id="analyzeBtn">Analizează</button>

  <div class="result" id="result">Aici vor apărea rezultatele...</div>
  <!-- 🔗 Surse găsite automat -->
<div id="sources" class="sources"></div>
  <div class="verdict-bar" id="verdictBar"></div>
  <canvas id="chart" width="320" height="180"></canvas>

  <div class="legend">
    ✅ Verde = Veridic / Coeziv | ⚠️ Galben = Ambiguu / incert | 🔴 Roșu = Fals / Manipulator
  </div>
<!-- 🧠 Legendă formula Coeziv 3.14 -->
<div class="legend-container" style="margin-top:1.5rem; padding:1rem; background:#0d1117; border:1px solid #1f2937; border-radius:12px; font-family:'Segoe UI',sans-serif; color:#d1d5db;">
  <h3 style="font-size:1rem; color:#22d3ee; margin-bottom:0.5rem;">🧭 Interpretarea Formulei 3.14Δ</h3>
  <ul style="list-style:none; margin:0; padding:0; line-height:1.6;">
    <li>🟩 <b>Fc (Coeziune logică)</b> — măsoară stabilitatea internă a informației, consistența logică și claritatea gramaticală.</li>
    <li>🟨 <b>Δ (Vibrație semantică)</b> — reprezintă activitatea informațională neutră, adică variațiile naturale de sens și ton, fără intenție de manipulare.</li>
    <li>🟥 <b>Manipulare (%)</b> — indică tendința de distorsionare sau dezechilibru al mesajului, intenționat sau emoțional.</li>
  </ul>
  <p style="font-size:0.85rem; color:#9ca3af; margin-top:0.6rem;">
    🔹 <b>Notă:</b> Culoarea galbenă (<b>Δ</b>) nu semnifică eroare — ci doar vibrația vie a informației, adică faptul că textul transmite sens activ, nu static.
  </p>
</div>
  <footer>© 2025 Coeziv 3.14 </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById("chart").getContext("2d");
  const chart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["Fc (Coeziune)", "Δ (Vibrație)", "Manipulare %"],
      datasets: [{
        label: "Valori analiză",
        data: [0, 0, 0],
        backgroundColor: ["#00ffb7", "#ffcc00", "#ff3366"]
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true, max: 6.3, ticks: { color: "#ccc" } },
        x: { ticks: { color: "#ccc" } }
      },
      plugins: { legend: { display: false } }
    }
  });

  const verdictBar = document.getElementById("verdictBar");
  const resultDiv = document.getElementById("result");

  // ✅ verdict text mare
  const verdictText = document.createElement("div");
  verdictText.style.fontSize = "1.4em";
  verdictText.style.fontWeight = "bold";
  verdictText.style.marginTop = "0.8em";
  verdictText.style.transition = "color 0.4s";
  document.body.insertBefore(verdictText, verdictBar);

  document.getElementById("analyzeBtn").addEventListener("click", async () => {
    const text = document.getElementById("textInput").value.trim();
    if (!text) {
      resultDiv.textContent = "⚠️ Introdu un text pentru analiză.";
      return;
    }

    resultDiv.textContent = "⏳ Analiză în curs...";
    verdictBar.style.background = "#444";
    verdictText.textContent = "";

    try {
      const response = await fetch("/api/analyze", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ textDeAnalizat: text }),
      });

      const data = await response.json();
      if (data.success) {
        const { fc, delta, manipulare, text: rezumat } = data.rezultat;
        resultDiv.textContent = rezumat;

   // 🧠 Afișăm sursele găsite automat
const sourcesDiv = document.getElementById("sources");
if (data.rezultat?.surse && data.rezultat.surse.length > 0) {
  sourcesDiv.innerHTML = `<b>🔗 Surse găsite:</b><br>` +
    data.rezultat.surse.map(s => {
      const isTrusted = /(bbc\.com|cnn\.com|nytimes\.com|reuters\.com|theguardian\.com|apnews\.com|mediafax\.ro|agerpres\.ro)/i.test(s.url);
      const badge = isTrusted ? `<span class="badge">✅ verificat</span>` : `<span class="badge gray">ℹ️ neconfirmat</span>`;
      return `<div class="source-item">${badge} <a href="${s.url}" target="_blank">${s.title}</a> <small>(${s.source})</small></div>`;
    }).join("");
} else {
  sourcesDiv.innerHTML = `<i>Nicio sursă relevantă găsită.</i>`;
}     chart.data.datasets[0].data = [fc, delta, manipulare];
        chart.update();

        // 🧠 Verdict vizual + text logic
        let verdictColor = "#00ffb7";
        let verdictMsg = "✅ Veridic / Coeziv";

        if (rezumat.toLowerCase().includes("fals") || rezumat.toLowerCase().includes("dezinformare")) {
          verdictColor = "#ff3366";
          verdictMsg = "🔴 Fals logic / Dezinformare";
        } else if (rezumat.toLowerCase().includes("ambiguu") || manipulare > 25) {
          verdictColor = "#ffcc00";
          verdictMsg = "⚠️ Ambiguu / Incomplet";
        } else if (rezumat.toLowerCase().includes("veridic") || manipulare < 20) {
          verdictColor = "#00ffb7";
          verdictMsg = "✅ Veridic / Coeziv";
        }

        verdictBar.style.background = verdictColor;
        verdictText.textContent = verdictMsg;
        verdictText.style.color = verdictColor;
      } else {
        resultDiv.textContent = "❌ Eroare: " + data.error;
        verdictText.textContent = "❌ Eroare API";
        verdictBar.style.background = "#ff3366";
      }
    } catch (err) {
      resultDiv.textContent = "⚠️ Eroare de conexiune cu motorul GPT.";
      verdictBar.style.background = "#ff3366";
      verdictText.textContent = "⚠️ Eroare conexiune";
      verdictText.style.color = "#ff3366";
    }
  });
</script>
</body>
</html>








